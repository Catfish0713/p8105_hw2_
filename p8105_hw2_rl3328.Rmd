---
title: "p8105_hw2_rl3328"
author: "Ruixi Li"
date: "2023-09-28"
output: html_document
---

# import and clean data
```{r setup, message=FALSE}
library(tidyverse)
library(readr)
library(readxl)
```


# Problem 1

## import and clean pols-month
```{r}
pols = 
  read_csv("./fivethirtyeight_datasets/fivethirtyeight_datasets/pols-month.csv") |>
  janitor::clean_names() |>#this step can be ignored cuz the variable names are clean
  separate(
    col = mon, 
    into = c("year","month","day"), 
    sep = "-") |>#I used `remove = FALSE` to check if I have done it correctly(not shown)
  mutate(month = tolower(month.abb[as.numeric(month)]))|>#I assume month name is abbreviation
  mutate(president =recode(prez_gop, "0" = "dem", "1" = "gop", "2" = "gop")) |>
  select(-c("prez_gop","prez_dem","day"))




```

## import and clean snp

```{r error_but_, include=FALSE}
#can use this approach if years are divided by 1968.
snp = 
  read_csv("./fivethirtyeight_datasets/fivethirtyeight_datasets/snp.csv") |>
  janitor::clean_names() |>#this step can be ignored cuz the variable names are clean
  mutate(date = mdy(date)) |>
  separate(
    col = date, 
    into = c("year","month","day"), 
    sep = "-") |>#I used `remove = FALSE` to check if I have done it correctly(not shown)
  mutate(month = tolower(month.abb[as.numeric(month)])) |>
  select(-"day")
```

After knowing the range of years, I assign the date into correct century.
```{r}
snp = 
  read_csv("./fivethirtyeight_datasets/fivethirtyeight_datasets/snp.csv") |>
  janitor::clean_names() |>#this step can be ignored cuz the variable names are clean
  separate(
    col = date, 
    into = c("month","day","year"), 
    sep = "/") |>#I used `remove = FALSE` to check if I have done it correctly(not shown)
  mutate(year = ifelse(as.numeric(year)>15, 1900+as.numeric(year), 2000+as.numeric(year)),
         month = tolower(month.abb[as.numeric(month)])) |>
  select(-"day")
```


## import and clean unemployment

```{r}
unemployment = 
  read_csv("./fivethirtyeight_datasets/fivethirtyeight_datasets/unemployment.csv") |>
  janitor::clean_names() |>
  pivot_longer(
    -year,
    names_to = "month", 
    values_to = "unemployment")  
```

## merge three datasets together
Join the datasets by merging `snp`into `pols`, and merging `unemployment` into the result.

```{r merge}
snp =
  snp |> mutate(year = as.character(year))

results = 
  left_join(pols, snp, by = c("year","month"))

unemployment =
  unemployment |> mutate(year = as.character(year))

results = 
  left_join(results, unemployment, by = c("year","month"))

```


# Problem 2

## import and clean mr. transh wheel
```{r}
mr = read_excel("trash.xlsx", 1) |>
  janitor::clean_names() |>
  select(-c(15,16)) |>
  mutate(month = ifelse(month == "Decemeber","December",month),
         sports_balls = round(sports_balls))

str(mr)

summary(mr)

```
there's one `NA` in `dumpster` variable, one `NA` in `date` variable and  61 `NAs` in `homes_powered` variable.


delete this row whose dumpster is `NA`

```{r}
mr = drop_na(mr, dumpster)
```

* calculate homes powered

* according to `home powered note`, Homes Powered - Each ton of trash equates to on average 500 kilowatts of electricity.  An average household will use 30 kilowatts per day.


```{r}
mr = mr |> mutate(homes_powered = (weight_tons*500)/30,
                  trash_wheel_name = "Mr.Trash Wheel")
```


## import and clean Professor Trash Wheel and Gwynnda

```{r}
pro = read_excel("trash.xlsx", 2) |>
  janitor::clean_names() |>
  drop_na(dumpster) |>
  mutate(homes_powered = (weight_tons*500)/30,
         trash_wheel_name = "Professor Trash Wheel",
         year = as.character(year))
  

str(pro)

summary(pro)



gwy = read_excel("trash.xlsx", 4) |>
  janitor::clean_names() |>
  drop_na(dumpster) |>
  mutate(homes_powered = (weight_tons*500)/30,
         trash_wheel_name = "Gwynnda Trash Wheel",
         year = as.character(year),
         month = ifelse(month == "july","July",month))


str(gwy)
summary(gwy)
```

## combine them together

```{r}
trash =  bind_rows(mr,gwy,pro)
```



```{r}
trash |> group_by(month) |> summarise(sum_trash=sum(weight_tons),
            .groups = 'drop')
```

Let's talk about the Mr. Trash Wheel datasets. The `mr` data has `r nrow(mr)` observations and `r ncol(mr)` variables and tells us about the amount of trash the dumpster receives(measured by both weight `weight_tons` and volume `volume_cubic_yards`), fill time`month`,`year`,`date` and the categories of trash`r colnames(mr[,7:15])` for "Mr. Trash Wheel" from years `r range(mr$year)[1]` to `r range(mr$year)[2]`. It also tells us how many homes can be powered by the electricity produced by trash incineration. The `pro` data has `r nrow(pro)` observations and `r ncol(pro)` variables, ranging from years `r range(pro$year)[1]` to `r range(pro$year)[2]`. The `gwy` data has `r nrow(gwy)` observations and `r ncol(gwy)` variables ranging from years `r range(gwy$year)[1]` to `r range(gwy$year)[2]`.**The total weight of trash collected by Professor Trash Wheel was `r filter(trash, trash_wheel_name == "Professor Trash Wheel") |> pull(weight_tons) |> sum() |> round(2)`**. **The total number of cigarette butts collected by Gwynnda in July of 2021 was `r filter(trash, year == "2021", month == "July",trash_wheel_name == "Gwynnda Trash Wheel") |> pull(cigarette_butts) |> sum()`**.



# Problem 3

