---
title: "p8105_hw2_rl3328"
author: "Ruixi Li"
date: "2023-09-28"
output: html_document
---

# import and clean data
```{r setup, message=FALSE}
library(tidyverse)
library(readr)
```


# Problem 1

First, clean the data in pols-month.csv. Use separate() to break up the variable mon into integer variables year, month, and day; replace month number with month name; create a president variable taking values gop and dem, and remove prez_dem and prez_gop; and remove the day variable.
```{r}
pols = 
  read_csv("./fivethirtyeight_datasets/fivethirtyeight_datasets/pols-month.csv") |>
  janitor::clean_names() |>#this step can be ignored cuz the variable names are clean
  separate(
    col = mon, 
    into = c("year","month","day"), 
    sep = "-") |>#I used `remove = FALSE` to check if I have done it correctly(not shown)
  mutate(month = tolower(month.abb[as.numeric(month)]))|>#I assume month name is abbreviation
  mutate(president =recode(prez_gop, "0" = "dem", "1" = "gop", "2" = "gop")) |>
  select(-c("prez_gop","prez_dem","day"))




```


Second, clean the data in snp.csv using a similar process to the above. For consistency across datasets, arrange according to year and month, and organize so that year and month are the leading columns.

```{r error_but_, include=FALSE}
#can use this approach if years are divided by 1968.
snp = 
  read_csv("./fivethirtyeight_datasets/fivethirtyeight_datasets/snp.csv") |>
  janitor::clean_names() |>#this step can be ignored cuz the variable names are clean
  mutate(date = mdy(date)) |>
  separate(
    col = date, 
    into = c("year","month","day"), 
    sep = "-") |>#I used `remove = FALSE` to check if I have done it correctly(not shown)
  mutate(month = tolower(month.abb[as.numeric(month)])) |>
  select(-"day")
```

After knowing the range of years, I assign the date into correct century.
```{r}
snp = 
  read_csv("./fivethirtyeight_datasets/fivethirtyeight_datasets/snp.csv") |>
  janitor::clean_names() |>#this step can be ignored cuz the variable names are clean
  separate(
    col = date, 
    into = c("month","day","year"), 
    sep = "/") |>#I used `remove = FALSE` to check if I have done it correctly(not shown)
  mutate(year = ifelse(as.numeric(year)>15, 1900+as.numeric(year), 2000+as.numeric(year)),
         month = tolower(month.abb[as.numeric(month)])) |>
  select(-"day")
```


Third, tidy the unemployment data so that it can be merged with the previous datasets. This process will involve switching from “wide” to “long” format; ensuring that key variables have the same name; and ensuring that key variables take the same values.

```{r}
unemployment = 
  read_csv("./fivethirtyeight_datasets/fivethirtyeight_datasets/unemployment.csv") |>
  janitor::clean_names() |>
  pivot_longer(
    -year,
    names_to = "month", 
    values_to = "unemployment")  
```

Join the datasets by merging `snp`into `pols`, and merging `unemployment` into the result.

```{r merge}
snp =
  snp |> mutate(year = as.character(year))

results = 
  left_join(pols, snp, by = c("year","month"))

unemployment =
  unemployment |> mutate(year = as.character(year))

results = 
  left_join(results, unemployment, by = c("year","month"))

```

check
```{r}
filter(results, month == "jan", as.numeric(year) >= 1975, president == "dem") |> pull(unemployment) |> mean() |> round(2)
```

# Problem 2

# Problem 3

